# ูุนูุงุฑูุฉ ุงูุชุทุจูู ๐๏ธ

ูุฐุง ุงูููู ูุดุฑุญ ูุนูุงุฑูุฉ ุชุทุจูู ููุฑููู ูููููุฉ ุนูู ุงูููููุงุช ุงููุฎุชููุฉ.

## ูุธุฑุฉ ุนุงูุฉ

ุชุทุจูู ููุฑููู ูุจูู ุนูู ูุนูุงุฑูุฉ **MVVM** (Model-View-ViewModel) ุจุงุณุชุฎุฏุงู ุฃุญุฏุซ ุชูููุงุช Android.

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         UI Layer (Compose)          โ
โ  MainActivity.kt + ChatBubble        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ   ViewModel Layer (State Management) โ
โ        ChatViewModel.kt              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ      Network Layer (API)             โ
โ      OpenAIService.kt                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ       External API (OpenAI)          โ
โ    api.openai.com/v1/chat/...       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ุงูููููุงุช ุงูุฑุฆูุณูุฉ

### 1. UI Layer (ุงูุทุจูุฉ ุงููุงุฌูุฉ)

#### MainActivity.kt
- **ุงูุฏูุฑ**: ุนุฑุถ ูุงุฌูุฉ ุงููุญุงุฏุซุฉ ุงูุฑุฆูุณูุฉ
- **ุงููุณุคูููุงุช**:
  - ุนุฑุถ ุงูุฑุณุงุฆู ูู ูุงุฆูุฉ (LazyColumn)
  - ูุนุงูุฌุฉ ุฅุฏุฎุงู ุงููุณุชุฎุฏู
  - ุนุฑุถ ูุคุดุฑ ุงูุชุญููู
  - ุงูุฑุณูู ุงููุชุญุฑูุฉ

#### ChatBubble Composable
- **ุงูุฏูุฑ**: ุนุฑุถ ููุงุนุฉ ุฑุณุงูุฉ ูุงุญุฏุฉ
- **ุงูููุฒุงุช**:
  - ุชูููุฒ ุฑุณุงุฆู ุงููุณุชุฎุฏู ูุงูู AI
  - ุฑุณูู ูุชุญุฑูุฉ ุนูุฏ ุงูุธููุฑ
  - ุชุตููู ูุณุชุฌูุจ

#### LoadingBubble Composable
- **ุงูุฏูุฑ**: ุนุฑุถ ูุคุดุฑ ุงูุชุญููู
- **ุงูููุฒุงุช**:
  - ููุงุท ูุชุญุฑูุฉ
  - ุชุตููู ูุชุทุงุจู ูุน ุงูููุงุนุงุช

### 2. ViewModel Layer (ุทุจูุฉ ุฅุฏุงุฑุฉ ุงูุญุงูุฉ)

#### ChatViewModel.kt
- **ุงูุฏูุฑ**: ุฅุฏุงุฑุฉ ุญุงูุฉ ุงููุญุงุฏุซุฉ
- **ุงููุณุคูููุงุช**:
  - ุชุฎุฒูู ุงูุฑุณุงุฆู (StateFlow)
  - ุชุชุจุน ุญุงูุฉ ุงูุชุญููู
  - ุฅุฑุณุงู ุงูุฑุณุงุฆู ุฅูู API
  - ุงูุญูุงุธ ุนูู ุณุฌู ุงููุญุงุฏุซุฉ

**ุงูุญุงูุงุช (State):**
```kotlin
messages: StateFlow<List<String>>  // ูุงุฆูุฉ ุงูุฑุณุงุฆู
isLoading: StateFlow<Boolean>      // ุญุงูุฉ ุงูุชุญููู
```

**ุงูุฏูุงู:**
```kotlin
sendMessage(userMessage: String)   // ุฅุฑุณุงู ุฑุณุงูุฉ ุฌุฏูุฏุฉ
```

### 3. Network Layer (ุทุจูุฉ ุงูุดุจูุฉ)

#### OpenAIService.kt
- **ุงูุฏูุฑ**: ุงูุชูุงุตู ูุน OpenAI API
- **ุงููุณุคูููุงุช**:
  - ุจูุงุก ุทูุจ API
  - ุฅุฑุณุงู ุงูุทูุจ
  - ูุนุงูุฌุฉ ุงูุฑุฏ
  - ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก

**ุงูุฏูุงู ุงูุฑุฆูุณูุฉ:**
```kotlin
getKorokoResponse(userMessage, history): String
buildSystemPrompt(): String
buildMessages(userMessage, history, systemPrompt): JsonArray
parseResponse(response: String): String
```

## ุชุฏูู ุงูุจูุงูุงุช

### ุนูููุฉ ุฅุฑุณุงู ุฑุณุงูุฉ:

```
1. ุงููุณุชุฎุฏู ููุชุจ ุฑุณุงูุฉ
   โ
2. ูุถุบุท ุฒุฑ ุงูุฅุฑุณุงู
   โ
3. MainActivity ูุณุชุฏุนู viewModel.sendMessage()
   โ
4. ChatViewModel ูุถูู ุงูุฑุณุงูุฉ ุฅูู ูุงุฆูุฉ ุงูุฑุณุงุฆู
   โ
5. ChatViewModel ูุนููู isLoading = true
   โ
6. ChatViewModel ูุณุชุฏุนู aiService.getKorokoResponse()
   โ
7. OpenAIService ูุจูู ุทูุจ API
   โ
8. OpenAIService ูุฑุณู ุงูุทูุจ ุฅูู OpenAI
   โ
9. OpenAI ูุฑุณู ุงูุฑุฏ
   โ
10. OpenAIService ูุญูู ุงูุฑุฏ
    โ
11. ChatViewModel ูุถูู ุฑุฏ ููุฑููู ุฅูู ุงูุฑุณุงุฆู
    โ
12. ChatViewModel ูุนููู isLoading = false
    โ
13. MainActivity ูุญุฏูุซ ุงููุงุฌูุฉ ุชููุงุฆูุงู
    โ
14. ุงููุณุชุฎุฏู ูุฑู ุฑุฏ ููุฑููู
```

## ูููุฐุฌ ุงูุจูุงูุงุช

### Message Format
```
ุฃูุช: [ุฑุณุงูุฉ ุงููุณุชุฎุฏู]
ููุฑููู: [ุฑุฏ ููุฑููู]
```

### Conversation History
```kotlin
conversationHistory: MutableList<String> = mutableListOf(
    "ูุฑุญุจุงู",
    "ูุฑุญุจุงู! ููู ุญุงููุ",
    "ุฃูุง ุจุฎูุฑุ ุดูุฑุงู",
    "..."
)
```

### API Request Format
```json
{
    "model": "gpt-4-mini",
    "messages": [
        {
            "role": "system",
            "content": "ุฃูุชู ููุฑููู..."
        },
        {
            "role": "user",
            "content": "ูุฑุญุจุงู"
        }
    ],
    "temperature": 0.85,
    "max_tokens": 600,
    "top_p": 0.9
}
```

## ุฅุฏุงุฑุฉ ุงูุญุงูุฉ (State Management)

### StateFlow
ูุณุชุฎุฏู `StateFlow` ูู Kotlin Coroutines ูุฅุฏุงุฑุฉ ุงูุญุงูุฉ:

```kotlin
private val _messages = MutableStateFlow<List<String>>(emptyList())
val messages: StateFlow<List<String>> = _messages

// ูู ุงูู UI:
val messages by viewModel.messages.collectAsState()
```

### ุงููููุฒุงุช:
- ุชุญุฏูุซ ุชููุงุฆู ููู UI ุนูุฏ ุชุบููุฑ ุงูุญุงูุฉ
- ุขูู ูู ุชุณุฑุจ ุงูุฐุงูุฑุฉ
- ูุนูู ูุน Jetpack Compose ุจุณูุงุณุฉ

## ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก

### ูู ChatViewModel:
```kotlin
try {
    val response = aiService.getKorokoResponse(...)
    // ุฅุถุงูุฉ ุงูุฑุฏ
} catch (e: Exception) {
    // ุฅุถุงูุฉ ุฑุณุงูุฉ ุฎุทุฃ
} finally {
    _isLoading.value = false
}
```

### ูู OpenAIService:
```kotlin
try {
    val response = client.post(apiUrl) { ... }
    return parseResponse(response)
} catch (e: Exception) {
    return "ุขุณูุฉุ ูู ุฃุชููู ูู ุงูุฑุฏ ุงูุขู..."
}
```

## ุงูุฃุฏุงุก ูุงูุชุญุณููุงุช

### ุชุญุณููุงุช ุญุงููุฉ:
- โ ุงุณุชุฎุฏุงู `LazyColumn` ูุนุฑุถ ุงูุฑุณุงุฆู
- โ ุชูุฑูุฑ ุชููุงุฆู ุฅูู ุขุฎุฑ ุฑุณุงูุฉ
- โ Coroutines ููุนูููุงุช ุบูุฑ ุงููุชุฒุงููุฉ
- โ ุชุฌูุจ ุฅุนุงุฏุฉ ุงูุชุตููุฑ ุบูุฑ ุงูุถุฑูุฑูุฉ

### ุชุญุณููุงุช ูุณุชูุจููุฉ:
- ๐ ุญูุธ ุงููุญุงุฏุซุงุช ูู ูุงุนุฏุฉ ุจูุงูุงุช (Room)
- ๐ ุชุฎุฒูู ูุคูุช (Caching) ููุฑุฏูุฏ
- ๐ ุชุญููู ุงูุตูุฑ ุจุดูู ุบูุฑ ูุชุฒุงูู
- ๐ ุถุบุท ุงูุจูุงูุงุช ุงููุฑุณูุฉ

## ุงูุฃูุงู

### ุงูููุงุฑุณุงุช ุงูุญุงููุฉ:
- โ ุงุณุชุฎุฏุงู HTTPS
- โ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
- โ ุชุฌูุจ ุชุณุฑุจ ุงูุจูุงูุงุช

### ุงูููุงุฑุณุงุช ุงููุณุชูุจููุฉ:
- ๐ ุชุดููุฑ ุงูุจูุงูุงุช ุงููุญููุธุฉ
- ๐ ุงุณุชุฎุฏุงู Keystore ููููุงุชูุญ
- ๐ ุชุณุฌูู ุงูุฃูุดุทุฉ (Logging)

## ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑุงุช ุงููุญุฏุฉ (Unit Tests):
```kotlin
@Test
fun testSendMessage() {
    // ุงุฎุชุจุงุฑ ุฅุฑุณุงู ุฑุณุงูุฉ
}

@Test
fun testParseResponse() {
    // ุงุฎุชุจุงุฑ ุชุญููู ุงูุฑุฏ
}
```

### ุงุฎุชุจุงุฑุงุช ุงูุชูุงูู (Integration Tests):
```kotlin
@Test
fun testFullConversation() {
    // ุงุฎุชุจุงุฑ ูุญุงุฏุซุฉ ูุงููุฉ
}
```

## ุงููููุงุช ูุงููุฌูุฏุงุช

```
app/
โโโ src/main/
โ   โโโ kotlin/com/example/korokoai/
โ   โ   โโโ MainActivity.kt          # ุงููุงุฌูุฉ ุงูุฑุฆูุณูุฉ
โ   โ   โโโ ui/
โ   โ   โ   โโโ ChatViewModel.kt     # ุฅุฏุงุฑุฉ ุงูุญุงูุฉ
โ   โ   โ   โโโ theme/
โ   โ   โ       โโโ Theme.kt         # ูุธุงู ุงูุฃููุงู
โ   โ   โ       โโโ Type.kt          # Typography
โ   โ   โโโ network/
โ   โ       โโโ OpenAIService.kt     # ุฎุฏูุฉ API
โ   โโโ res/
โ   โ   โโโ drawable/                # ุงูุตูุฑ ูุงูุฑุณููุงุช
โ   โ   โโโ values/
โ   โ       โโโ colors.xml           # ุงูุฃููุงู
โ   โ       โโโ strings.xml          # ุงููุตูุต
โ   โ       โโโ styles.xml           # ุงูุฃููุงุท
โ   โโโ AndroidManifest.xml          # ุฅุนุฏุงุฏุงุช ุงูุชุทุจูู
โโโ build.gradle.kts                 # ุฅุนุฏุงุฏุงุช ุงูุจูุงุก
```

## ุงูุฎูุงุตุฉ

ูุนูุงุฑูุฉ ุงูุชุทุจูู ูุตููุฉ ูุชููู:
- **ุจุณูุทุฉ**: ุณููุฉ ุงูููู ูุงูุชุทููุฑ
- **ูุงุจูุฉ ููุชูุณุน**: ูููู ุฅุถุงูุฉ ููุฒุงุช ุฌุฏูุฏุฉ ุจุณูููุฉ
- **ุขููุฉ**: ุชุชุจุน ุฃูุถู ุงูููุงุฑุณุงุช ุงูุฃูููุฉ
- **ูุนุงูุฉ**: ุชุญุณููุงุช ุงูุฃุฏุงุก ูุงูุฐุงูุฑุฉ

---

**ูููุฒูุฏ ูู ุงููุนูููุงุชุ ุฑุงุฌุน ุงููููุงุช ุงูุฃุฎุฑู ูู ุงููุดุฑูุน! ๐**
